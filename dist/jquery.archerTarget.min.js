/*! jQuery ArcherTarget | v0.3.0pre | http://archertarget.andremeyering.de | (c) 2013 Andre Meyering | Licensed MIT */ 
(function(t,e,r){"use strict";t.DEVMODE===undefined&&(t.DEVMODE=0);var a="archerTarget",o={target:"wa_x",targetDefaults:{center:[50,50],diameter:90,style:{initial:{opacity:1},hover:{opacity:1},arrowOn:{opacity:1},arrowOff:{opacity:.8}}},arrows:{},arrowDefaults:{active:!0,draggable:!0,radius:5,style:{initial:{opacity:.9,color:"#00ff00",stroke:!1},hover:{opacity:1},selected:{opacity:1}},target:0},backgroundColor:"transparent",draggable:!0,scale:1,maxScale:6,minScale:.6,scaleStep:.2,scalable:!0,transX:0,transY:0,arrowClass:"arrow",plugins:{}},i={onTargetOver:"targetOver",onTargetOut:"targetOut",onTargetMove:"targetMove",onTargetClick:"targetClick",onArrowOver:"arrowOver",onArrowOut:"arrowOut",onArrowMove:"arrowMove",onArrowSelect:"arrowSelect",onArrowDeselect:"arrowDeselect",onScale:"zoom",onContainerTap:"containerTap",onContainerMousedown:"containerMousedown"},s={get:{ring:1,targetParams:1,transform:1,arrows:1},set:{arrowOptions:1,arrowActive:1,arrowStyle:1,backgroundColor:1,scale:1,transform:1}},n=function(t,e){var s=this;this.options=e=r.extend(!0,{},o,e),this._defaults=o,this._name=a,s.$container=r(t),s.$containerId=t.id?t.id:s.GUID();for(var n in i)i.hasOwnProperty(n)&&e[n]&&r(t).on(i[n]+".archerTarget",e[n]);s.init()};n.Targets={},n.Plugins={},r.fn.archerTarget=function(t){var e=arguments;if("addTarget"===t)return n.Targets[arguments[1]]=arguments[2],r(this);if("addPlugin"===t)return n.Plugins[arguments[1]]=arguments[2],r(this);if("set"===t||"get"===t){var o;return s[t][e[1]]||r.error("Method "+t+e[1]+" does not exist on jQuery."+a),o=t+e[1].charAt(0).toUpperCase()+e[1].substr(1),r(this).data("plugin_"+a)[o].apply(r(this).data("plugin_"+a),Array.prototype.slice.call(e,2))}return"object"!=typeof t&&t?(r.error("Method "+t+" does not exist on jQuery."+a),undefined):this.each(function(){r(this).data("plugin_"+a)||r(this).data("plugin_"+a,new n(this,t))})},n.prototype.GUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=0|16*Math.random(),r="x"===t?e:8|3&e;return r.toString(16)})},n.prototype.RAF=function(){var e,r=0,a=["ms","moz","webkit","o"];for(e=0;a.length>e&&!t.requestAnimationFrame;e++)t.requestAnimationFrame=t[a[e]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[a[e]+"CancelAnimationFrame"]||t[a[e]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(e){var a=(new Date).getTime(),o=Math.max(0,16-(a-r)),i=t.setTimeout(function(){e(a+o)},o);return r=a+o,i}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})},n.prototype.bindArrowEvents=function(){var e,a,o,i,s,n,c,l,g=this,d={},h={},u=this.$container.offset().left,p=this.$container.offset().top,v=0;g.arrowMoving=!1,i=function(){if(!g.arrowMoving||!h.data.draggable)return!1;if(d.el.setPosition({x:a,y:o}),h.data.draggable instanceof Object&&g.setArrowPointer({x:a,y:o,drag:h.data.draggable,arrowRadius:h.data.radius}),d.ring=g.calculateRing({x:a,y:o-v,target:e}),d.x=g.convertTo.pcX(a,e),d.y=g.convertTo.pcY(o-v,e),d.ring=d.ring,!g.checkOnTarget(d)){var r=g.checkClosestTarget(e,{x:a,y:o});e!==r&&(d.target=e=r,g.setTargetStyle("arrow",{active:e}))}g.arrowList[h.id]=h.data,g.arrowList[h.id].data[d.id]=d,t.requestAnimationFrame(i),d.$el.trigger("arrowMove.archerTarget",[h.id,d.id,g.arrowList])},s=function(t){return g.arrowMoving&&(a=t.pageX-u,o=t.pageY-p),!1},n=function(s){if(!g.arrowMoving){var n,c=this.parentNode,l=r(this).attr("class");h.id=parseInt(c.id.substr(c.id.indexOf("_")+1),10),h.data=g.arrowList[h.id],e=h.data.target,n=-1===l.indexOf(" ")?parseInt(l,10):parseInt(l.substr(0,l.indexOf(" ")),10),d=h.data.data[n],d.el=this,d.$el=r(this),d.id=n}return"mousedown"===s.type?(a=s.pageX-u||g.convertTo.pxX(d.x,e),o=s.pageY-p||g.convertTo.pxY(d.y,e),g.arrowMoving=!0,h.data.draggable&&(g.setTargetStyle("arrow",{active:e}),g.$container[0].style.cursor="move"),d.el.setAttribute("fill",h.data.style.selected.color),d.$el.css({opacity:h.data.style.selected.opacity}).trigger("arrowSelect.archerTarget",[h.id,d.id,g.arrowList]),h.data.draggable instanceof Object&&h.data.draggable?(g.createArrowPointer({x:g.convertTo.pxX(d.x,e),y:g.convertTo.pxY(d.y,e),drag:h.data.draggable,color:h.data.style.selected.color,arrowRadius:h.data.radius}),v=h.data.draggable.height+h.data.radius):v=0,t.cancelAnimationFrame(i),t.requestAnimationFrame(i)):"mouseover"!==s.type||g.arrowMoving||(d.el.setAttribute("fill",h.data.style.hover.color),d.$el.css({opacity:h.data.style.hover.opacity}).trigger("arrowOver.archerTarget",[h.id,d.id])),!1},c=function(){return g.arrowMoving&&(g.arrowMoving=!1,g.setTargetStyle("initial"),d.el.setAttribute("fill",h.data.style.hover.color),h.data.draggable instanceof Object&&(g.removeArrowPointer(),d.el.setPosition({x:g.convertTo.pxX(d.x,e),y:g.convertTo.pxY(d.y,e)})),g.$container[0].style.cursor="default",r(g.$container).trigger("arrowDeselect.archerTarget",[h.id,d.id,g.arrowList])),!1},l=function(){return g.arrowMoving&&h.data.draggable||(d.el.setAttribute("fill",h.data.style.initial.color),d.$el.css({opacity:h.data.style.initial.opacity}).trigger("arrowOut.archerTarget",[h.id,d.id])),!1},this.$container.on("mousemove",s).on("mouseup click",c).find(".arrowSetCanvas").on("mouseout","circle",l).on("mousedown mouseover","circle",n)},n.prototype.bindArrowTouchEvents=function(){var e,a,o,i,s,n,c,l,g=this,d={},h={},u=this.$container.offset().left,p=this.$container.offset().top,v=0;g.arrowMoving=!1,s=function(){if(!g.arrowMoving||!h.data.draggable)return!1;if(d.el.setPosition({x:a,y:o}),h.data.draggable instanceof Object&&g.setArrowPointer({x:a,y:o,drag:h.data.draggable,arrowRadius:h.data.radius}),d.ring=g.calculateRing({x:a,y:o-v,target:e}),d.x=g.convertTo.pcX(a,e),d.y=g.convertTo.pcY(o-v,e),!g.checkOnTarget(d)){var r=g.checkClosestTarget(e,{x:a,y:o});e!==r&&(d.target=e=r,g.setTargetStyle("arrow",{active:e}))}g.arrowList[h.id]=h.data,g.arrowList[h.id].data[d.id]=d,t.requestAnimationFrame(s),d.$el.trigger("arrowMove.archerTarget",[h.id,d.id,g.arrowList])},n=function(t){return g.arrowMoving?(i=t.originalEvent.touches[0],a=i.pageX-u,o=i.pageY-p,!1):!1},c=function(n){if(!g.arrowMoving){var c,l=this.parentNode,f=r(this).attr("class");h.id=parseInt(l.id.substr(l.id.indexOf("_")+1),10),h.data=g.arrowList[h.id],e=h.data.target,c=-1===f.indexOf(" ")?parseInt(f,10):parseInt(f.substr(0,f.indexOf(" ")),10),d=h.data.data[c],d.el=this,d.$el=r(this),d.id=c}return!n.originalEvent&&arguments[1]&&(n.originalEvent=arguments[1].originalEvent),i=n.originalEvent.touches[0],a=i.pageX-u||g.convertTo.pxX(d.x,e),o=i.pageY-p||g.convertTo.pxY(d.y,e),g.arrowMoving=!0,h.data.draggable&&(g.setTargetStyle("arrow",{active:e}),g.$container[0].style.cursor="move"),d.el.setAttribute("fill",h.data.style.selected.color),d.$el.css({opacity:h.data.style.selected.opacity}).trigger("arrowSelect.archerTarget",[h.id,d.id,g.arrowList]),h.data.draggable instanceof Object&&h.data.draggable?(g.createArrowPointer({x:g.convertTo.pxX(d.x,e),y:g.convertTo.pxY(d.y,e),drag:h.data.draggable,color:h.data.style.selected.color,arrowRadius:h.data.radius}),v=h.data.draggable.height+h.data.radius):v=0,1===n.originalEvent.touches.length&&h.data.draggable&&(t.cancelAnimationFrame(s),t.requestAnimationFrame(s)),!1},l=function(){return g.arrowMoving?(g.arrowMoving=!1,g.setTargetStyle("initial"),d.el.setAttribute("fill",h.data.style.hover.color),h.data.draggable instanceof Object&&(g.removeArrowPointer(),d.el.setPosition({x:g.convertTo.pxX(d.x,e),y:g.convertTo.pxY(d.y,e)})),g.$container[0].style.cursor="default",g.$container.trigger("arrowDeselect.archerTarget",[h.id,d.id,g.arrowList]),!1):!1},this.$container.on("touchmove",n).on("touchend",l).find(".arrowSetCanvas").on("touchstart","circle",c)},n.prototype.bindContainerEvents=function(){var e=this,a=!1;if(this.draggable){var o,i,s,n,c,l,g,d,h=!1,u=this.$container.find("svg")[0];c=function(){h&&(e.transX=(s-o)/e.scale,e.transY=(n-i)/e.scale,a=!0,e.setTransform(),t.requestAnimationFrame(c),e.$container.trigger("targetMove.archerTarget",[]))},l=function(t){h&&(s=t.pageX,n=t.pageY)},g=function(r){o=r.pageX-e.transX*e.scale,i=r.pageY-e.transY*e.scale,s=r.pageX,n=r.pageY,h=!0,a=!1,u.style.cursor="move",t.cancelAnimationFrame(c),t.requestAnimationFrame(c)},d=function(){h=a=!1,u.style.cursor="default"},this.$container.on("mousemove","svg",l).on("mousedown","svg",g).on("mouseup",d)}this.$container.on("mousedown click",function(t){if(!a&&!r(t.target).hasClass("archerTarget-zoomin")&&!r(t.target).hasClass("archerTarget-zoomout")){var o=t.pageX-r(this).offset().left,i=t.pageY-r(this).offset().top,s=e.checkClosestTarget(0,{x:o,y:i}),n=[{x:100*(o/e.width),y:100*(i/e.height),xPx:o,yPx:i},{x:e.convertTo.pcX(o,s),y:e.convertTo.pcY(i,s),target:s}];"mousedown"===t.type?e.$container.trigger("containerMousedown.archerTarget",n):e.$container.trigger("containerTap.archerTarget",n)}})},n.prototype.bindContainerTouchEvents=function(){var e,a=this,o=!1;if(this.options.draggable){var i,s,n,c,l,g,d,h,u=!1,p=this.$container.find("svg")[0];l=function(){u&&(a.transX=(n-i)/a.scale,a.transY=(c-s)/a.scale,o=!0,a.setTransform(),t.requestAnimationFrame(l),a.$container.trigger("targetMove.archerTarget",[]))},g=function(t){u&&(e=t.originalEvent.touches[0],n=e.pageX,c=e.pageY)},d=function(r){e=r.originalEvent.touches[0],i=e.pageX-a.transX*a.scale,s=e.pageY-a.transY*a.scale,n=e.pageX,c=e.pageY,u=!0,o=!1,p.style.cursor="move",t.cancelAnimationFrame(l),t.requestAnimationFrame(l)},h=function(){u=o=!1,p.style.cursor="default"},this.$container.on("touchmove","svg, .targetCanvas",g).on("touchstart","svg, .targetCanvas",d).on("touchend","svg, .targetCanvas",h)}this.$container.on("touchstart touchend",function(t){if(!o&&!r(t.target).hasClass("archerTarget-zoomin")&&!r(t.target).hasClass("archerTarget-zoomout")){var i,s,n,c,l=r(this).offset().left,g=r(this).offset().top;"touchstart"===t.type?(e=event.touches[0],i=e.pageX-l,s=e.pageY-g):(e=event.changedTouches[0],i=e.pageX-l,s=e.pageY-g),n=a.checkClosestTarget(0,{x:i,y:s}),c=[{x:100*(i/a.width),y:100*(s/a.height),xPx:i,yPx:s},{x:a.convertTo.pcX(i,n),y:a.convertTo.pcY(s,n),target:n},t],"touchstart"===t.type?a.$container.trigger("containerMousedown.archerTarget",c):a.$container.trigger("containerTap.archerTarget",c)}})},n.prototype.bindTargetEvents=function(){var t=this;r(t.targetList).each(function(e,r){r.$el.parent().on("mouseenter",function(){return t.arrowMoving?!1:(r.$el.css({opacity:r.style.hover.opacity}).trigger("targetOver.archerTarget",[e]),!1)}).on("mouseleave",function(){return t.arrowMoving?!1:(r.$el.css({opacity:r.style.initial.opacity}).trigger("targetOut.archerTarget",[e]),!1)}).on("click",function(){r.$el.trigger("targetClick.archerTarget",[e])})})},n.prototype.bindTargetTouchEvents=function(){var t=this;r(this.target).each(function(e,r){r.$el.on("mouseover",function(){return t.arrowMoving?!1:(r.$el.css({opacity:r.style.hover.opacity}).trigger("targetOver.archerTarget",[e]),!1)}).on("mouseout",function(){return t.arrowMoving?!1:(r.$el.css({opacity:r.style.initial.opacity}).trigger("targetOut.archerTarget",[e]),!1)}).on("click",function(){r.$el.trigger("targetClick.archerTarget",[e])})})},n.prototype.bindZoomEvents=function(){var t=this,e=0;this.$container.on("click",".archerTarget-zoomin",function(){t.scale<=t.maxScale&&(e=t.scale+t.scaleStep),t.setZoom(e)}).on("click",".archerTarget-zoomout",function(){t.scale>=t.minScale+t.scaleStep&&(e=t.scale-t.scaleStep),t.setZoom(e)})},n.prototype.calculateRing=function(t){var e,r,a=this,o=a.targetList[t.target],i=n.Targets[o.name],s={x:0,y:0,diagonal:0},c={x:(a.convertTo.canvasX(o.center[0])+a.transX)*a.scale,y:(a.convertTo.canvasY(o.center[1])+a.transY)*a.scale,radius:a.convertTo.canvasX(o.diameter)/2*a.scale,numberRings:i.numberRings};if(s.x=t.x>=c.x?c.x-t.x:t.x-c.x,s.y=t.y>=c.y?t.y-c.y:c.y-t.y,s.diagonal=0===s.x&&0===s.y?0:Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2)),s.diagonal>c.radius+1)return 0;for(e=c.numberRings-1;e>=0;e--)if(r=a.convertTo.canvasX(i.diameters[e],o.diameter)/2*a.scale+1,r>=s.diagonal)return i.rating[e]},n.prototype.checkClosestTarget=function(t,e){var r,a,o,i,s,n=this,c=n.convertTo,l=n.targetList.length;for(r=0;l>r;r++)if(s=n.targetList[r],a=(c.canvasX(s.center[0])+n.transX)*n.scale,o=(c.canvasY(s.center[1])+n.transY)*n.scale,i=c.canvasX(s.diameter)/2*n.scale,e.x>a-i&&a+i>e.x&&e.y>o-i&&o+i>e.y)return r;return t},n.prototype.checkOnTarget=function(t,e){if(1>=this.targetList.length)return!0;var r=e&&e.tolerance?e:{tolerance:5};return t.x>100+r.tolerance||t.y>100+r.tolerance||t.x<-r.tolerance||t.y<-r.tolerance?!1:!0},n.prototype.createArrowPointer=function(t){var e=this;e.dragMark={},e.dragMark.el=e.canvas.createGroup(!1,{id:e.$containerId+"ArrowDrag"}),e.dragMark.rect=e.canvas.createRect({x:t.x-t.drag.width/2,y:t.y-t.drag.height-t.arrowRadius,width:t.drag.width,height:t.drag.height,fill:t.color}),e.dragMark.el.appendChild(e.dragMark.rect),e.dragMark.circle=e.canvas.createCircle({x:t.x,y:t.y-t.drag.height-t.arrowRadius,radius:t.drag.width,fill:t.color,stroke:!1,eleClass:!1}),e.dragMark.el.appendChild(e.dragMark.circle),e.canvas.canvas.appendChild(e.dragMark.el)},n.prototype.createArrows=function(t){t||(t=[]);var e,a,o,i,s,n,c=this,l={height:40,width:5},g=t.length;for(c.arrowGroup=c.canvas.createGroup(!1,{id:c.$containerId+"ArrowGroup"}),c.canvas.canvas.appendChild(c.arrowGroup),e=0;g>e;e++){for(t[e]=i instanceof Array?{data:t[e]}:t[e],t[e]=r.extend(!0,{},c.options.arrowDefaults,t[e]),i=t[e],i.draggable instanceof Object&&(i.draggable=r.extend(!0,{},l,i.draggable)),i.el=c.canvas.createGroup(!1,{id:c.$containerId+"ArrowSet_"+e,eleClass:"arrowSetCanvas"}),i.$el=r(i.el),s=i.data.length,a=0;s>a;a++)n=i.data[a],c.targetList[i.target]||(i.target=0),n.target=n.target||i.target,c.targetList[n.target]||(n.target=0),n.active===undefined&&(n.active=i.active),o=n.active?"":" hidden",n.el=c.canvas.createCircle({x:c.convertTo.pxX(n.x,n.target),y:c.convertTo.pxY(n.y,n.target),radius:i.radius,fill:i.style.initial.color,stroke:i.style.initial.stroke,eleClass:a+o}),n.$el=r(n.el),n.$el.css({opacity:i.style.initial.opacity}),i.$el.append(n.el);c.arrowGroup.appendChild(i.el)}return t},n.prototype.createTarget=function(t){var e,a,o,i,s=this;for(t=t||[],e=0;t.length>e;e++){for(t[e]=r.extend(!0,{},this.options.targetDefaults,t[e]),o=t[e],o.originalCenter=o.center,o.el=this.canvas.createGroup(!1,{id:s.$containerId+"Target_"+e,eleClass:"targetCanvas"}),o.$el=r(o.el),o.rings=[],a=0;n.Targets[o.name].numberRings>a;a++)o.rings[a]={},i=n.Targets[o.name].diameters[a],o.rings[a].el=this.canvas.createCircle({x:this.convertTo.canvasX(o.center[0]),y:this.convertTo.canvasY(o.center[1]),radius:this.convertTo.canvasX(i,o.diameter)/2,fill:n.Targets[o.name].colors[a],stroke:n.Targets[o.name].strokeColors[a],eleClass:a}),o.$el.append(o.rings[a].el);this.targetGroup.appendChild(o.el),o.$el.css({opacity:o.style.initial.opacity})}return t},n.prototype.getArrows=function(){return this.arrowList},n.prototype.getRing=function(t){if(t)return this.calculateRing({x:this.convertTo.pxX(t.x,t.target),y:this.convertTo.pxY(t.y,t.target),target:t.target});var e,r,a;for(e=0;this.arrow.length>e;e++)for(r=0;this.arrow[e].data.length>r;r++)a=this.arrow[e].data[r],a.ring=this.calculateRing({x:this.convertTo.pxX(a.x,a.target),y:this.convertTo.pxY(a.y,a.target),target:a.target});return this.arrow},n.prototype.getTargetParams=function(t){return n.Targets[t]},n.prototype.getTransform=function(){return{x:this.transX,y:this.transY,scale:this.scale}},n.prototype.init=function(){var t=this;t.$container.addClass("archerTargetContainer").css({position:"relative",overflow:"hidden"}),t.transX=t.options.transX,t.transY=t.options.transY,t.scale=t.options.scale,t.pluginList=t.options.plugins,t.mergeStyles(),t.setBackgroundColor(t.options.backgroundColor),t.initConverter(),t.RAF(),t.setSize(),t.canvas=new c(t.width,t.height),t.$container.append(t.canvas.canvas),t.targetGroup=t.canvas.createGroup(!0,{id:t.$containerId+"TargetGroup"}),t.canvas.canvas.appendChild(t.targetGroup),t.targetList=t.createTarget(t.options.target instanceof Array?t.options.target:[{name:t.options.target}]),this.setGap(),this.arrowList=this.createArrows(t.options.arrows),t.isTouch()?(this.bindContainerTouchEvents(),this.bindArrowTouchEvents(),this.bindTargetTouchEvents()):(this.bindContainerEvents(),this.bindArrowEvents(),this.bindTargetEvents()),this.scalable&&(r("<div/>").addClass("archerTarget-zoomin").text("+").appendTo(t.$container),r("<div/>").addClass("archerTarget-zoomout").html("&#x2212;").appendTo(t.$container),this.bindZoomEvents()),this.setTransform(),t.initPlugins()},n.prototype.initConverter=function(){var t=this,e={x:{},y:{}};t.convertTo={pcX:function(e,r){return r||(r=0),100*((e/t.scale-t.gap[r].left-t.transX)/t.convertTo.canvasX(t.targetList[r].diameter))},pcY:function(e,r){return r||(r=0),100*((e/t.scale-t.gap[r].top-t.transY)/t.convertTo.canvasX(t.targetList[r].diameter))},pxX:function(e,r){return r||(r=0),(t.convertTo.canvasX(t.targetList[r].diameter)/100*e+t.gap[r].left+t.transX)*t.scale},pxY:function(e,r){return r||(r=0),(t.convertTo.canvasX(t.targetList[r].diameter)/100*e+t.gap[r].top+t.transY)*t.scale},canvasX:function(r,a){a||(a=100),e.x[a]||(e.x[a]={});var o=e.x[a];return o[r]||(o[r]=t.width/100*a/100*r),o[r]},canvasY:function(r,a){a||(a=100),e.y[a]||(e.y[a]={});var o=e.y[a];return o[r]||(o[r]=t.height/100*a/100*r),o[r]}}},n.prototype.initPlugins=function(){var t;for(t in this.pluginList)this.pluginList.hasOwnProperty(t)&&n.Plugins[t]&&n.Plugins[t].initialize(this,this.pluginList[t])},n.prototype.isTouch=function(){return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch||this.options.touch===!0},n.prototype.mergeStyles=function(){var t,e=this,a=e.options;for(t in a.targetDefaults.style)a.targetDefaults.style.hasOwnProperty(t)&&(a.targetDefaults.style[t]=r.extend({},a.targetDefaults.style.initial,a.targetDefaults.style[t]));for(t in a.arrowDefaults.style)a.arrowDefaults.style.hasOwnProperty(t)&&(a.arrowDefaults.style[t]=r.extend({},a.arrowDefaults.style.initial,a.arrowDefaults.style[t]))},n.prototype.removeArrowPointer=function(){this.canvas.canvas.removeChild(this.dragMark.el)},n.prototype.setArrowActive=function(t){var e,r=this,a=function(t,e,a){a===undefined?a=r.arrowList[t].data[e].active:r.arrowList[t].data[e].active=a;var o=r.arrowList[t].data[e].el,i=a?"":" hidden";o.setAttribute("class",e+i)},o=function(t,o){o!==undefined&&(r.arrowList[t].active=o);var i=r.arrowList[t].data.length;for(e=0;i>e;e++)a(t,e,o)};t.arrowID!==undefined?a(t.arrowsetID,t.arrowID,t.active):o(t.arrowsetID,t.active)},n.prototype.setArrowOptions=function(t){var e,a,o=this;for(e in t.options)if(t.options.hasOwnProperty(e)&&(a="setArrow"+e.charAt(0).toUpperCase()+e.substr(1),t.options[e]!==o.arrowList[t.arrowsetID][e]))switch(e){case"active":o[a]({arrowsetID:t.arrowsetID,active:t.options[e]});break;default:}r.extend(!0,o.arrowList[t.arrowsetID],t.options)},n.prototype.setArrowPointer=function(t){this.dragMark.rect.setPosition({x:t.x-t.drag.width/2,y:t.y-t.drag.height-t.arrowRadius}),this.dragMark.circle.setPosition({x:t.x,y:t.y-t.drag.height-t.arrowRadius})},n.prototype.setArrowPosition=function(t){var e,a,o=this,i=o.convertTo.pxX,s=o.convertTo.pxY,n={},c=function(t,e){var r=o.arrowList[t].data[e];r.el.setPosition({x:i(r.x,r.target),y:s(r.y,r.target)})};if(t===undefined)for(e=0;o.arrowList.length>e;e++)for(a=0;o.arrowList[e].data.length>a;a++)c(e,a);else if(t=r.extend({},n,t),t.arrowsetID instanceof Array)for(e=0;t.arrowsetID.length>e;e++)for(a=0;o.arrowList[t.arrowsetID[e]].data.length>a;a++)c(t.arrowsetID[e],a);else if(t.arrowID!==undefined)if(t.arrowID instanceof Array)for(e=0;t.arrowID.length>e;e++)c(t.arrowsetID,t.arrowID[e]);else c(t.arrowsetID,t.arrowID);else for(c(t.arrowsetID,t.active),e=0;o.arrowList[t.arrowsetID].data.length>e;e++)c(t.arrowsetID,e)},n.prototype.setArrowStyle=function(t){var e,a,o=this,i={style:o.options.arrowDefaults.style.initial},s=function(t,e){var r;for(e.radius||(e.radius=o.arrowList[t].radius),a=0;o.arrowList[t].data.length>a;a++)r=o.arrowList[t].data[a],r.el.setStyle({stroke:e.stroke,radius:e.radius,fill:e.color}),r.$el.css({opacity:e.opacity})},n=function(t,e,r){var a=o.arrowList[t].data[e];r.radius||(r.radius=o.arrowList[t].radius),a.el.setStyle({stroke:r.stroke,radius:r.radius,fill:r.color}),a.$el.css({opacity:r.opacity})};if(t=r.extend({},i,t),t.arrowsetID instanceof Array)if(t.style instanceof Array)for(e=0;t.arrowsetID.length>e;e++)s(t.arrowsetID[e],t.style[e]);else for(e=0;t.arrowsetID.length>e;e++)s(t.arrowsetID[e],t.style);else if(t.arrowID!==undefined)if(t.arrowID instanceof Array)if(t.style instanceof Array)for(e=0;t.arrowID.length>e;e++)n(t.arrowsetID,t.arrowID[e],t.style[e]);else for(e=0;t.arrowID.length>e;e++)n(t.arrowsetID,t.arrowID[e],t.style);else n(t.arrowsetID,t.arrowID,t.style);else s(t.arrowsetID,t.style)},n.prototype.setBackgroundColor=function(t){this.backgroundColor=t,this.$container.css({backgroundColor:t})},n.prototype.setGap=function(){var t,e;for(this.gap=[],t=0;this.targetList.length>t;t++)e=this.targetList[t],this.gap[t]={top:this.convertTo.canvasY(e.center[1])-this.convertTo.canvasX(e.diameter/2),left:this.convertTo.canvasX(e.center[0]-e.diameter/2)}},n.prototype.setSize=function(){this.width=this.$container.width(),this.height=this.$container.height()||this.$container.width()},n.prototype.setTargetStyle=function(t,e){var r,a=this.targetList;switch(t){case"initial":for(r=0;a.length>r;r++)a[r].$el.css({opacity:a[r].style.initial.opacity});break;case"arrow":var o;for(r=0;a.length>r;r++)o=r===e.active?"arrowOn":"arrowOff",a[r].$el.css({opacity:a[r].style[o].opacity})}},n.prototype.setTransform=function(t,e,r){t||0===t?this.transX=t:t=this.transX,e||0===e?this.transY=e:e=this.transY,r?this.scale=r:r=this.scale,this.canvas.applyTransformParams(r,t,e),this.setArrowPosition()},n.prototype.setZoom=function(t){this.$container.trigger("zoom.archerTarget",[t,this.scale]),this.scale=t,this.setTransform(),this.clearConverterCache()};var c=function(r,a){if(this.mode=t.SVGAngle?"svg":"vml","svg"===this.mode)this.createSvgNode=function(t){return e.createElementNS(this.svgns,t)};else{try{e.namespaces.rvml||e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),this.createVmlNode=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(o){this.createVmlNode=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)")}"svg"===this.mode?this.canvas=this.createSvgNode("svg"):(this.canvas=this.createVmlNode("group"),this.canvas.style.position="absolute"),this.setSize(r,a)};c.prototype={svgns:"http://www.w3.org/2000/svg",mode:"svg",width:0,height:0,canvas:null,setSize:function(t,e){var r,a,o;if("svg"===this.mode)this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e);else if(this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.canvas.coordsize=t+" "+e,this.canvas.coordorigin="0 0",this.rootGroup){for(o=this.rootGroup.getElementsByTagName("shape"),r=0,a=o.length;a>r;r++)o[r].coordsize=t+" "+e,o[r].style.width=t+"px",o[r].style.height=e+"px";this.rootGroup.coordsize=t+" "+e,this.rootGroup.style.width=t+"px",this.rootGroup.style.height=e+"px"}this.width=t,this.height=e},createCircle:function(t){var e;return"svg"===this.mode?(e=this.createSvgNode("circle"),e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),e.setAttribute("r",t.radius),e.setAttribute("fill",t.fill),e.setAttribute("stroke",t.stroke),e.setAttribute("class",t.eleClass),e.setPosition=function(t){e.setAttribute("cx",t.x),e.setAttribute("cy",t.y)},e.setStyle=function(t){e.setAttribute("r",t.radius),e.setAttribute("fill",t.fill),e.setAttribute("stroke",t.stroke)}):(e=this.createVmlNode("oval"),e.style.width=2*t.radius+"px",e.style.height=2*t.radius+"px",e.style.left=t.x-t.radius+"px",e.style.top=t.y-t.radius+"px",e.fillcolor=t.fill,e.classList.add(t.eleClass),e.stroke=!0,e.strokecolor=t.stroke,e.setPosition=function(r){e.style.left=r.x-t.radius+"px",e.style.top=r.y-t.radius+"px"},e.setStyle=function(t){e.style.width=2*t.radius+"px",e.style.height=2*t.radius+"px",e.fillcolor=t.fill,e.stroke=!0,e.strokecolor=t.stroke}),e},createRect:function(t){var e;return"svg"===this.mode?(e=this.createSvgNode("rect"),e.setAttribute("x",t.x),e.setAttribute("y",t.y),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e.setAttribute("fill",t.fill),e.setPosition=function(t){e.setAttribute("x",t.x),e.setAttribute("y",t.y)}):(e=this.createVmlNode("rect"),e.style.width=t.width+"px",e.style.height=t.width+"px",e.style.left=t.x+"px",e.style.top=t.y+"px",e.fillcolor=t.fill,e.setPosition=function(t){e.style.left=t.x+"px",e.style.top=t.y+"px"}),e},createGroup:function(t,e){var r;return e=e||{},"svg"===this.mode?(r=this.createSvgNode("g"),e.id&&(r.id=e.id),e.eleClass&&r.setAttribute("class",e.eleClass)):(r=this.createVmlNode("group"),r.style.width=this.width+"px",r.style.height=this.height+"px",r.style.left="0px",r.style.top="0px",r.coordorigin="0 0",e.id&&(r.id=e.id),e.eleClass&&r.classList.add(e.eleClass),r.coordsize=this.width+" "+this.height),t&&(this.rootGroup=r),r},applyTransformParams:function(t,e,r){"svg"===this.mode?this.rootGroup.setAttribute("transform","scale("+t+") translate("+e+", "+r+")"):(this.rootGroup.coordorigin=this.width-e-this.width/100+","+(this.height-r-this.height/100),this.rootGroup.coordsize=this.width/t+","+this.height/t)}}})(window,document,window.jQuery||window.Zepto);
//@ sourceMappingURL=dist/jquery.archerTarget.min.map