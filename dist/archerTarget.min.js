/*! archerTarget.js | v0.3.2 | https://github.com/archer96/archerTarget.js | (c) 2013 Andre Meyering | Licensed MIT */ 
!function(a,b,c){"use strict";function d(){var b,c=0,d=["ms","moz","webkit","o"];for(b=0;b<d.length&&!a.requestAnimationFrame;b++)a.requestAnimationFrame=a[d[b]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[d[b]+"CancelAnimationFrame"]||a[d[b]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(b){var d=(new Date).getTime(),e=Math.max(0,16-(d-c)),f=a.setTimeout(function(){b(d+e)},e);return c=d+e,f}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}function e(a,b,c){for(var d=0,e=a.length;e>d;d++)a[d].addEventListener(b,c,!1)}function f(a){return"object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName}function g(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName}function h(a){return a&&"[object Function]"===Object.prototype.toString.call(a)}function i(a){return a&&"[object Array]"===Object.prototype.toString.call(a)}function j(a){return!(a instanceof Array||"number"==typeof a||"string"==typeof a||"boolean"==typeof a||f(a)||g(a))}"undefined"==typeof a.DEVMODE&&(a.DEVMODE=0);var k="archerTarget",l={target:"wa_x",targetDefaults:{center:[50,50],diameter:90,style:{initial:{opacity:1},hover:{opacity:1},arrowOn:{opacity:1},arrowOff:{opacity:.8}}},arrows:{},arrowDefaults:{active:!0,draggable:!0,radius:5,style:{initial:{opacity:.9,color:"#00ff00",stroke:!1},hover:{opacity:1},selected:{opacity:1}},target:0},backgroundColor:"transparent",draggable:!0,scale:1,maxScale:6,minScale:.6,scaleStep:.2,scalable:!0,zoomInButton:"+",zoomOutButton:"&#x2212;",transX:0,transY:0,arrowClass:"arrow",plugins:{},isTouch:null},m={onTargetOver:"targetOver",onTargetOut:"targetOut",onTargetMove:"targetMove",onTargetClick:"targetClick",onArrowOver:"arrowOver",onArrowOut:"arrowOut",onArrowMove:"arrowMove",onArrowSelect:"arrowSelect",onArrowDeselect:"arrowDeselect",onScale:"zoom",onContainerTap:"containerTap",onContainerMousedown:"containerMousedown"},n={};a.ArcherTarget=function(a,b){if("undefined"==typeof this)throw new Error('"this" is undefined. use "new ArcherTarget(...)"and NOT "ArcherTarget(...)"');var c=this;return a.id||(a.id=ArcherTarget.GUID()),c._id=a.id,n[c._id]=new o(a,b),c},ArcherTarget.addTarget=function(a,b){o.Targets[a]=b},ArcherTarget.addPlugin=function(a,b){o.Plugins[a]=b};var o=function(a,b){var c=this;c._name=k,c._defaults=l,c._id=a.id,c.options=ArcherTarget.extend(!0,{},l,b),c.container=a,c.containerId=c._id;for(var d in m)m.hasOwnProperty(d)&&b[d]&&a.addEventListener(m[d]+".archerTarget",b[d],!1);c.init()};o.Targets={},o.Plugins={},ArcherTarget.GUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"===a?b:8|3&b;return c.toString(16)})},o.prototype.bindArrowEvents=function(){var b,c,d,f,g,h,i,j,k=this,l={},m={},n=ArcherTarget.offset(k.container).left,o=ArcherTarget.offset(k.container).top,p=0;k.arrowMoving=!1,f=function(){if(!k.arrowMoving||!m.data.draggable)return!1;if(l.el.setPosition({x:c,y:d}),m.data.draggable instanceof Object&&k.setArrowPointer({x:c,y:d,drag:m.data.draggable,arrowRadius:m.data.radius}),l.ring=k.calculateRing({x:c,y:d-p,target:b}),l.x=k.convertTo.pcX(c,b),l.y=k.convertTo.pcY(d-p,b),l.ring=l.ring,!k.checkOnTarget(l)){var e=k.checkClosestTarget(b,{x:c,y:d});b!==e&&(l.target=b=e,k.setTargetStyle("arrow",{active:b}))}k.arrowList[m.id]=m.data,k.arrowList[m.id].data[l.id]=l,a.requestAnimationFrame(f),ArcherTarget.fireEvent(l.el,"arrowMove.archerTarget",{arrowset:m.id,arrow:l.id,arrows:k.arrowList})},g=function(a){return k.arrowMoving&&(c=a.pageX-n,d=a.pageY-o),!1},h=function(e){var g=e.target;if(!k.arrowMoving){var h,i=this.parentNode,j=g.className.baseVal;m.id=parseInt(i.id.substr(i.id.indexOf("_")+1),10),m.data=k.arrowList[m.id],b=m.data.target,h=-1===j.indexOf(" ")?parseInt(j,10):parseInt(j.substr(0,j.indexOf(" ")),10),l=m.data.data[h],l.el=this,l.id=h}return"mousedown"===e.type?(c=e.pageX-n||k.convertTo.pxX(l.x,b),d=e.pageY-o||k.convertTo.pxY(l.y,b),k.arrowMoving=!0,m.data.draggable&&(k.setTargetStyle("arrow",{active:b}),k.container.style.cursor="move"),l.el.setAttribute("fill",m.data.style.selected.color),l.el.style.opacity=m.data.style.selected.opacity,ArcherTarget.fireEvent(l.el,"arrowSelect.archerTarget",{arrowset:m.id,arrow:l.id,arrows:k.arrowList}),m.data.draggable instanceof Object&&m.data.draggable?(k.createArrowPointer({x:k.convertTo.pxX(l.x,b),y:k.convertTo.pxY(l.y,b),drag:m.data.draggable,color:m.data.style.selected.color,arrowRadius:m.data.radius}),p=m.data.draggable.height+m.data.radius):p=0,a.cancelAnimationFrame(f),a.requestAnimationFrame(f)):"mouseover"!==e.type||k.arrowMoving||(l.el.setAttribute("fill",m.data.style.hover.color),l.el.style.opacity=m.data.style.hover.opacity,ArcherTarget.fireEvent(l.el,"arrowOver.archerTarget",{arrowset:m.id,arrow:l.id,arrows:k.arrowList})),!1},i=function(){return k.arrowMoving&&(k.arrowMoving=!1,k.setTargetStyle("initial"),l.el.setAttribute("fill",m.data.style.hover.color),m.data.draggable instanceof Object&&(k.removeArrowPointer(),l.el.setPosition({x:k.convertTo.pxX(l.x,b),y:k.convertTo.pxY(l.y,b)})),k.container.style.cursor="default",ArcherTarget.fireEvent(k.container,"arrowDeselect.archerTarget",{arrowset:m.id,arrow:l.id,arrows:k.arrowList})),!1},j=function(){return k.arrowMoving&&m.data.draggable||(l.el.setAttribute("fill",m.data.style.initial.color),l.el.style.opacity=m.data.style.initial.opacity,ArcherTarget.fireEvent(l.el,"arrowOut.archerTarget",{arrowset:m.id,arrow:l.id,arrows:k.arrowList})),!1},this.container.addEventListener("mousemove",g),this.container.addEventListener("mouseup",i),this.container.addEventListener("click",i);var q=this.container.querySelectorAll(".arrowSetCanvas circle");e(q,"mouseout",j),e(q,"mousedown",h),e(q,"mouseover",h)},o.prototype.bindArrowTouchEvents=function(){var b,c,d,f,g,h,i,j,k,l,m=this,n={},o={},p=0;m.arrowMoving=!1,i=function(){if(!m.arrowMoving||!o.data.draggable)return!1;if(n.el.setPosition({x:c,y:d}),o.data.draggable instanceof Object&&m.setArrowPointer({x:c,y:d,drag:o.data.draggable,arrowRadius:o.data.radius}),n.ring=m.calculateRing({x:c,y:d-p,target:b}),n.x=m.convertTo.pcX(c,b),n.y=m.convertTo.pcY(d-p,b),!m.checkOnTarget(n)){var e=m.checkClosestTarget(b,{x:c,y:d});b!==e&&(n.target=b=e,m.setTargetStyle("arrow",{active:b}))}m.arrowList[o.id]=o.data,m.arrowList[o.id].data[n.id]=n,a.requestAnimationFrame(i),ArcherTarget.fireEvent(n.el,"arrowMove.archerTarget",{arrowset:o.id,arrow:n.id,arrows:m.arrowList})},j=function(a){return m.arrowMoving?(h=a.touches[0],c=h.pageX-f,d=h.pageY-g,!1):!1},k=function(e){var j=e.target;if(!m.arrowMoving){f=ArcherTarget.offset(m.container).left,g=ArcherTarget.offset(m.container).top;var k,l=j.parentNode,q=j.className.baseVal;o.id=parseInt(l.id.substr(l.id.indexOf("_")+1),10),o.data=m.arrowList[o.id],b=o.data.target,k=-1===q.indexOf(" ")?parseInt(q,10):parseInt(q.substr(0,q.indexOf(" ")),10),n=o.data.data[k],n.el=j,n.id=k}return h=e.touches[0],c=h.pageX-f||m.convertTo.pxX(n.x,b),d=h.pageY-g||m.convertTo.pxY(n.y,b),m.arrowMoving=!0,o.data.draggable&&(m.setTargetStyle("arrow",{active:b}),m.container.style.cursor="move"),n.el.setAttribute("fill",o.data.style.selected.color),n.el.style.opacity=o.data.style.selected.opacity,ArcherTarget.fireEvent(n.el,"arrowSelect.archerTarget",{arrowset:o.id,arrow:n.id,arrows:m.arrowList}),o.data.draggable instanceof Object&&o.data.draggable?(m.createArrowPointer({x:m.convertTo.pxX(n.x,b),y:m.convertTo.pxY(n.y,b),drag:o.data.draggable,color:o.data.style.selected.color,arrowRadius:o.data.radius}),p=o.data.draggable.height+o.data.radius):p=0,1===e.touches.length&&o.data.draggable&&(a.cancelAnimationFrame(i),a.requestAnimationFrame(i)),!1},l=function(){return m.arrowMoving?(m.arrowMoving=!1,m.setTargetStyle("initial"),n.el.setAttribute("fill",o.data.style.hover.color),o.data.draggable instanceof Object&&(m.removeArrowPointer(),n.el.setPosition({x:m.convertTo.pxX(n.x,b),y:m.convertTo.pxY(n.y,b)})),m.container.style.cursor="default",ArcherTarget.fireEvent(m.container,"arrowDeselect.archerTarget",{arrowset:o.id,arrow:n.id,arrows:m.arrowList}),!1):!1},m.container.addEventListener("touchmove",j),m.container.addEventListener("touchend",l),e(m.container.querySelectorAll(".arrowSetCanvas circle"),"touchstart",k)},o.prototype.bindContainerEvents=function(){var b=this,c=!1;if(this.options.draggable){var d,f,g,h,i,j,k,l,m=!1,n=this.container.getElementsByTagName("svg")[0];i=function(){m&&(b.transX=(g-d)/b.scale,b.transY=(h-f)/b.scale,c=!0,b.setTransform(),a.requestAnimationFrame(i),ArcherTarget.fireEvent(b.container,"targetMove.archerTarget"))},j=function(a){m&&(g=a.pageX,h=a.pageY)},k=function(e){d=e.pageX-b.transX*b.scale,f=e.pageY-b.transY*b.scale,g=e.pageX,h=e.pageY,m=!0,c=!1,n.style.cursor="move",a.cancelAnimationFrame(i),a.requestAnimationFrame(i)},l=function(){m=c=!1,n.style.cursor="default"};var o=this.container.querySelectorAll("svg .targetCanvas");e(o,"mousemove",j),e(o,"mousedown",k),e(o,"mouseup",l)}b.container.addEventListener(b.container,"mousedown"),b.container.addEventListener(b.container,"click")},o.prototype.bindContainerTouchEvents=function(){var b,d=this,f=!1;if(this.options.draggable){var g,h,i,j,k,l,m,n,o=!1,p=this.container.getElementsByTagName("svg")[0];k=function(){o&&(d.transX=(i-g)/d.scale,d.transY=(j-h)/d.scale,f=!0,d.setTransform(),a.requestAnimationFrame(k),ArcherTarget.fireEvent(d.container,"targetMove.archerTarget"))},l=function(a){o&&!d.arrowMoving&&(b=a.touches[0],i=b.pageX,j=b.pageY)},m=function(c){d.arrowMoving||(b=c.touches[0],g=b.pageX-d.transX*d.scale,h=b.pageY-d.transY*d.scale,i=b.pageX,j=b.pageY,o=!0,f=!1,p.style.cursor="move",a.cancelAnimationFrame(k),a.requestAnimationFrame(k))},n=function(){d.arrowMoving||(o=f=!1,p.style.cursor="default")};var q=d.container.querySelectorAll("svg .targetCanvas");e(q,"touchmove",l),e(q,"touchstart",m),e(q,"touchend",n)}var r=function(a){if(!d.arrowMoving){var e=typeof a.target.className.baseVal!==c?a.target.className.baseVal:a.target.className;if(a.target,!f&&null===e.match(/archerTarget-zoomin/g)&&null===e.match(/archerTarget-zoomout/g)){var g,h,i,j,k=ArcherTarget.offset(d.container).left,l=ArcherTarget.offset(d.container).top;"touchstart"===a.type?(b=event.touches[0],g=b.pageX-k,h=b.pageY-l):(b=event.changedTouches[0],g=b.pageX-k,h=b.pageY-l),i=d.checkClosestTarget(0,{x:g,y:h}),j=[{x:100*(g/d.width),y:100*(h/d.height),xPx:g,yPx:h},{x:d.convertTo.pcX(g,i),y:d.convertTo.pcY(h,i),target:i},a],"touchstart"===a.type?ArcherTarget.fireEvent(d.container,"containerMousedown.archerTarget",{canvasCoords:j[0],targetCoords:j[1],touches:a.touches}):ArcherTarget.fireEvent(d.container,"containerTap.archerTarget",{canvasCoords:j[0],targetCoords:j[1],touches:a.touches})}}};d.container.addEventListener("touchstart",r),d.container.addEventListener("touchend",r)},o.prototype.bindTargetEvents=function(){function a(a,b){var c=b.el;c.addEventListener("click",function(){ArcherTarget.fireEvent(b.el,"targetClick.archerTarget",{index:a})})}for(var b=this,c=0;c<b.targetList.length;c++)a(c,b.targetList[c])},o.prototype.bindTargetTouchEvents=function(){function a(a,b){b.el.parentNode.addEventListener("touchend",function(){ArcherTarget.fireEvent(b.el,"targetClick.archerTarget",{index:a})})}for(var b=this,c=0;c<b.targetList.length;c++)a(c,b.targetList[c])},o.prototype.bindZoomEvents=function(){var a=this,b=0,c=this.container;c.querySelector(".archerTarget-zoomin").addEventListener("click",function(){a.scale<=a.options.maxScale&&(b=a.scale+a.options.scaleStep),a.setZoom(b)}),c.querySelector(".archerTarget-zoomout").addEventListener("click",function(){a.scale>=a.options.minScale+a.options.scaleStep&&(b=a.scale-a.options.scaleStep),a.setZoom(b)})},o.prototype.calculateRing=function(a){var b,c,d=this,e=d.targetList[a.target],f=o.Targets[e.name],g={x:0,y:0,diagonal:0},h={x:(d.convertTo.canvasX(e.center[0])+d.transX)*d.scale,y:(d.convertTo.canvasY(e.center[1])+d.transY)*d.scale,radius:d.convertTo.canvasX(e.diameter)/2*d.scale,numberRings:f.numberRings};if(g.x=a.x>=h.x?h.x-a.x:a.x-h.x,g.y=a.y>=h.y?a.y-h.y:h.y-a.y,g.diagonal=0===g.x&&0===g.y?0:Math.sqrt(Math.pow(g.x,2)+Math.pow(g.y,2)),g.diagonal>h.radius+1)return 0;for(b=h.numberRings-1;b>=0;b--)if(c=d.convertTo.canvasX(f.diameters[b],e.diameter)/2*d.scale+1,g.diagonal<=c)return f.rating[b]},o.prototype.checkClosestTarget=function(a,b){var c,d,e,f,g,h=this,i=h.targetList.length;for(c=0;i>c;c++)if(g=h.targetList[c],d=(h.convertTo.canvasX(g.center[0])+h.transX)*h.scale,e=(h.convertTo.canvasY(g.center[1])+h.transY)*h.scale,f=h.convertTo.canvasX(g.diameter)/2*h.scale,b.x>d-f&&b.x<d+f&&b.y>e-f&&b.y<e+f)return c;return a},o.prototype.checkOnTarget=function(a,b){if(this.targetList.length<=1)return!0;var c=b&&b.tolerance?b:{tolerance:5};return a.x>100+c.tolerance||a.y>100+c.tolerance||a.x<-c.tolerance||a.y<-c.tolerance?!1:!0},o.prototype.createArrowPointer=function(a){var b=this;b.dragMark={},b.dragMark.el=b.canvas.createGroup({id:b.$containerId+"ArrowDrag"}),b.dragMark.rect=b.canvas.createRect({x:a.x-a.drag.width/2,y:a.y-a.drag.height-a.arrowRadius,width:a.drag.width,height:a.drag.height,fill:a.color}),b.dragMark.el.appendChild(b.dragMark.rect),b.dragMark.circle=b.canvas.createCircle({x:a.x,y:a.y-a.drag.height-a.arrowRadius,radius:a.drag.width,fill:a.color,stroke:!1,eleClass:!1}),b.dragMark.el.appendChild(b.dragMark.circle),b.canvas.canvas.appendChild(b.dragMark.el)},o.prototype.createArrows=function(a){a||(a=[]);var b,c,d,e,f,g,h=this,i={height:40,width:5},j=a.length;for(h.arrowGroup=h.canvas.createGroup({id:h.containerId+"ArrowGroup"}),b=0;j>b;b++){for(a[b]=e instanceof Array?{data:a[b]}:a[b],a[b]=ArcherTarget.extend(!0,{},h.options.arrowDefaults,a[b]),e=a[b],e.draggable instanceof Object&&(e.draggable=ArcherTarget.extend(!0,{},i,e.draggable)),e.el=h.canvas.createGroup({id:h.containerId+"ArrowSet_"+b,eleClass:"arrowSetCanvas"}),f=e.data.length,c=0;f>c;c++)g=e.data[c],h.targetList[e.target]||(e.target=0),g.target=g.target||e.target,h.targetList[g.target]||(g.target=0),"undefined"==typeof g.active&&(g.active=e.active),d=g.active?"":" hidden",g.el=h.canvas.createCircle({x:h.convertTo.pxX(g.x,g.target),y:h.convertTo.pxY(g.y,g.target),radius:e.radius,fill:e.style.initial.color,stroke:e.style.initial.stroke,eleClass:c+d}),g.el.style.opacity=e.style.initial.opacity,e.el.appendChild(g.el);h.arrowGroup.appendChild(e.el)}return h.canvas.canvas.appendChild(h.arrowGroup),a},o.prototype.createTarget=function(a){var b,c,d,e,f=this;for(a=a||[],b=0;b<a.length;b++){for(a[b]=ArcherTarget.extend(!0,{},this.options.targetDefaults,a[b]),d=a[b],d.originalCenter=d.center,d.el=this.canvas.createGroup({id:f.containerId+"Target_"+b,eleClass:"targetCanvas"}),d.rings=[],c=0;c<o.Targets[d.name].numberRings;c++)d.rings[c]={},e=o.Targets[d.name].diameters[c],d.rings[c].el=this.canvas.createCircle({x:f.convertTo.canvasX(d.center[0]),y:f.convertTo.canvasY(d.center[1]),radius:f.convertTo.canvasX(e,d.diameter)/2,fill:o.Targets[d.name].colors[c],stroke:o.Targets[d.name].strokeColors[c],eleClass:c}),d.el.appendChild(d.rings[c].el);d.el.style.opacity=d.style.initial.opacity,this.targetGroup.appendChild(d.el)}return a},ArcherTarget.extend=function(){var a,b,d,e,f,g,k=arguments[0]||{},l=1,m=arguments.length,n=!1;for("boolean"==typeof k&&(n=k,k=arguments[1]||{},l=2),"object"!=typeof k&&h(k)&&(k={}),m===l&&(k=this,--l);m>l;l++)if(null!==(f=arguments[l]))for(e in f)if(f.hasOwnProperty(e)){if(a=k[e],d=f[e],k===d)continue;n&&d&&(j(d)||(b=i(d)))?(b?(b=!1,g=a&&i(a)?a:[]):g=a&&j(a)?a:{},k[e]=ArcherTarget.extend(n,g,d)):d!==c&&(k[e]=d)}return k},ArcherTarget.fireEvent=function(a,c,d){var e=b.createEvent("Event");if(e.initEvent(c,!0,!0),d)for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);a.dispatchEvent(e)},ArcherTarget.prototype.get=o.prototype.get=function(a){var b,c=n[this._id];return b={arrows:function(){return c.getArrows()}},a&&b[a]?arguments[1]?b[a].apply(null,Array.prototype.slice.call(arguments,1)):b[a]():void 0},o.prototype.getArrows=function(){return this.arrowList},o.prototype.getRing=function(a){var b=this;if(a)return b.calculateRing({x:b.convertTo.pxX(a.x,a.target),y:b.convertTo.pxY(a.y,a.target),target:a.target});var c,d,e;for(c=0;c<this.arrow.length;c++)for(d=0;d<this.arrow[c].data.length;d++)e=this.arrow[c].data[d],e.ring=b.calculateRing({x:b.convertTo.pxX(e.x,e.target),y:b.convertTo.pxY(e.y,e.target),target:e.target});return this.arrow},o.prototype.getSize=function(){var b=a.getComputedStyle(this.container,null);if(this.width=b.width,this.height=b.height||this.width,this.width.indexOf("px")>=0){var c=this.width;this.width=c.substr(0,c.length-2)}if(this.height.indexOf("px")>=0){var d=this.height;this.height=d.substr(0,d.length-2)}},o.prototype.getTransform=function(){return{x:this.transX,y:this.transY,scale:this.scale}},o.prototype.init=function(){var a=this;if(a.container.className+="archerTargetContainer",a.container.style.overflow="hidden",a.container.style.position="relative",a.transX=a.options.transX,a.transY=a.options.transY,a.scale=a.options.scale,a.pluginList=a.options.plugins,a.mergeStyles(),a.setBackgroundColor(a.options.backgroundColor),a.initConverter(),d(),a.getSize(),a.canvas=new p(a.width,a.height),a.container.appendChild(a.canvas.canvas),a.targetGroup=a.canvas.createGroup({id:a.containerId+"TargetGroup"},!0),a.canvas.canvas.appendChild(a.targetGroup),a.targetList=a.createTarget(a.options.target instanceof Array?a.options.target:[{name:a.options.target}]),a.setGap(),this.arrowList=a.createArrows(a.options.arrows),a.isTouch()?(a.bindContainerTouchEvents(),a.bindArrowTouchEvents(),a.bindTargetTouchEvents()):(a.bindContainerEvents(),a.bindArrowEvents(),a.bindTargetEvents()),a.options.scalable){var c=b.createElement("div"),e=b.createElement("div");c.className="archerTarget-zoomin",e.className="archerTarget-zoomout",c.innerHTML=a.options.zoomInButton,e.innerHTML=a.options.zoomOutButton,a.container.appendChild(c),a.container.appendChild(e),a.bindZoomEvents()}a.setTransform(),a.initPlugins()},o.prototype.initConverter=function(){var a=this,b={x:{},y:{}};a.convertTo={pcX:function(b,c){return c||(c=0),100*((b/a.scale-a.gap[c].left-a.transX)/a.convertTo.canvasX(a.targetList[c].diameter))},pcY:function(b,c){return c||(c=0),100*((b/a.scale-a.gap[c].top-a.transY)/a.convertTo.canvasX(a.targetList[c].diameter))},pxX:function(b,c){return c||(c=0),(a.convertTo.canvasX(a.targetList[c].diameter)/100*b+a.gap[c].left+a.transX)*a.scale},pxY:function(b,c){return c||(c=0),(a.convertTo.canvasX(a.targetList[c].diameter)/100*b+a.gap[c].top+a.transY)*a.scale},canvasX:function(c,d){d||(d=100),b.x[d]||(b.x[d]={});var e=b.x[d];return e[c]||(e[c]=a.width/100*d/100*c),e[c]},canvasY:function(c,d){d||(d=100),b.y[d]||(b.y[d]={});var e=b.y[d];return e[c]||(e[c]=a.height/100*d/100*c),e[c]}}},o.prototype.initPlugins=function(){var a;for(a in this.pluginList)this.pluginList.hasOwnProperty(a)&&o.Plugins[a]&&o.Plugins[a].initialize(this,this.pluginList[a])},o.prototype.isTouch=function(){var c=this;return null!==c.options.isTouch?c.options.isTouch:"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch||!1},o.prototype.mergeStyles=function(){var a,b=this,c=this.options;for(a in c.targetDefaults.style)c.targetDefaults.style.hasOwnProperty(a)&&(b.options.targetDefaults.style[a]=ArcherTarget.extend(!0,{},c.targetDefaults.style.initial,c.targetDefaults.style[a]));for(a in c.arrowDefaults.style)c.arrowDefaults.style.hasOwnProperty(a)&&(b.options.arrowDefaults.style[a]=ArcherTarget.extend(!0,{},c.arrowDefaults.style.initial,c.arrowDefaults.style[a]))},ArcherTarget.offset=function(b){if(0===b.length)return null;var c=b.getBoundingClientRect();return{left:c.left+a.pageXOffset,top:c.top+a.pageYOffset,width:Math.round(c.width),height:Math.round(c.height)}},o.prototype.removeArrowPointer=function(){this.canvas.canvas.removeChild(this.dragMark.el)},ArcherTarget.prototype.set=o.prototype.set=function(a){var b=n[this._id],c={arrowActive:function(a){b.setArrowActive(a)},arrowOptions:function(a){b.setArrowOptions(a)},transform:function(a,c,d){b.setTransform(a,c,d)}};return a&&c[a]?arguments[1]?c[a].apply(null,Array.prototype.slice.call(arguments,1)):c[a]():void 0},o.prototype.setArrowActive=function(a){var b=this,c=function(a,c,d){"undefined"==typeof d?d=b.arrowList[a].data[c].active:b.arrowList[a].data[c].active=d;var e=b.arrowList[a].data[c].el,f=d?"":" hidden";e.setAttribute("class",c+f)},d=function(a,d){var e;"undefined"!=typeof d&&(b.arrowList[a].active=d);var f=b.arrowList[a].data.length;for(e=0;f>e;e++)c(a,e,d)};"undefined"!=typeof a.arrowID?c(a.arrowsetID,a.arrowID,a.active):d(a.arrowsetID,a.active)},o.prototype.setArrowOptions=function(a){var b,c,d,e=this;d={active:function(b){e[b]({arrowsetID:a.arrowsetID,active:a.options.active})}};for(b in a.options)a.options.hasOwnProperty(b)&&(c="setArrow"+b.charAt(0).toUpperCase()+b.substr(1),a.options[b]!==e.arrowList[a.arrowsetID][b]&&d[b]&&d[b](c));ArcherTarget.extend(!0,e.arrowList[a.arrowsetID],a.options)},o.prototype.setArrowPointer=function(a){this.dragMark.rect.setPosition({x:a.x-a.drag.width/2,y:a.y-a.drag.height-a.arrowRadius}),this.dragMark.circle.setPosition({x:a.x,y:a.y-a.drag.height-a.arrowRadius})},o.prototype.setArrowPosition=function(a){var b,c,d=this,e=d.convertTo.pxX,f=d.convertTo.pxY,g={},h=function(a,b){var c=d.arrowList[a].data[b];c.el.setPosition({x:e(c.x,c.target),y:f(c.y,c.target)})};if("undefined"==typeof a)for(b=0;b<d.arrowList.length;b++)for(c=0;c<d.arrowList[b].data.length;c++)h(b,c);else if(a=ArcherTarget.extend(!0,{},g,a),a.arrowsetID instanceof Array)for(b=0;b<a.arrowsetID.length;b++)for(c=0;c<d.arrowList[a.arrowsetID[b]].data.length;c++)h(a.arrowsetID[b],c);else if("undefined"!=typeof a.arrowID)if(a.arrowID instanceof Array)for(b=0;b<a.arrowID.length;b++)h(a.arrowsetID,a.arrowID[b]);else h(a.arrowsetID,a.arrowID);else for(h(a.arrowsetID,a.active),b=0;b<d.arrowList[a.arrowsetID].data.length;b++)h(a.arrowsetID,b)},o.prototype.setArrowStyle=function(a){var b,c,d=this,e={style:d.options.arrowDefaults.style.initial},f=function(a,b){var e;for(b.radius||(b.radius=d.arrowList[a].radius),c=0;c<d.arrowList[a].data.length;c++)e=d.arrowList[a].data[c],e.el.setStyle({stroke:b.stroke,radius:b.radius,fill:b.color}),e.el.opacity=b.opacity},g=function(a,b,c){var e=d.arrowList[a].data[b];c.radius||(c.radius=d.arrowList[a].radius),e.el.setStyle({stroke:c.stroke,radius:c.radius,fill:c.color}),e.el.opacity=c.opacity};if(a=ArcherTarget.extend(!0,{},e,a),a.arrowsetID instanceof Array)if(a.style instanceof Array)for(b=0;b<a.arrowsetID.length;b++)f(a.arrowsetID[b],a.style[b]);else for(b=0;b<a.arrowsetID.length;b++)f(a.arrowsetID[b],a.style);else if("undefined"!=typeof a.arrowID)if(a.arrowID instanceof Array)if(a.style instanceof Array)for(b=0;b<a.arrowID.length;b++)g(a.arrowsetID,a.arrowID[b],a.style[b]);else for(b=0;b<a.arrowID.length;b++)g(a.arrowsetID,a.arrowID[b],a.style);else g(a.arrowsetID,a.arrowID,a.style);else f(a.arrowsetID,a.style)},o.prototype.setBackgroundColor=function(a){this.backgroundColor=this.container.style.backgroundColor=a},o.prototype.setGap=function(){var a,b,c=this;for(c.gap=[],a=0;a<c.targetList.length;a++)b=c.targetList[a],c.gap[a]={top:c.convertTo.canvasY(b.center[1])-c.convertTo.canvasX(b.diameter/2),left:c.convertTo.canvasX(b.center[0]-b.diameter/2)}},o.prototype.setTargetStyle=function(a,b){var c,d,e=this.targetList;d={initial:function(){for(c=0;c<e.length;c++)e[c].el.style.opacity=e[c].style.initial.opacity},arrow:function(){var a;for(c=0;c<e.length;c++)a=c===b.active?"arrowOn":"arrowOff",e[c].el.style.opacity=e[c].style[a].opacity}},d[a]&&d[a]()},o.prototype.setTransform=function(a,b,c){a||0===a?this.transX=a:a=this.transX,b||0===b?this.transY=b:b=this.transY,c?this.scale=c:c=this.scale,this.canvas.applyTransformParams(c,a,b),this.setArrowPosition()},o.prototype.setZoom=function(a){ArcherTarget.fireEvent(this.container,"zoom.archerTarget",{newScale:a,oldScale:this.scale}),this.scale=a,this.setTransform()};var p=function(c,d){a.SVGAngle||alert("No SVG supported!"),this.createSvgNode=function(a){return b.createElementNS("http://www.w3.org/2000/svg",a)},this.canvas=this.createSvgNode("svg"),this.setSize(c,d)};p.prototype={width:0,height:0,canvas:null,setSize:function(a,b){this.canvas.setAttribute("width",a),this.canvas.setAttribute("height",b),this.width=a,this.height=b},createCircle:function(a){var b=this.createSvgNode("circle");return b.setAttribute("cx",a.x),b.setAttribute("cy",a.y),b.setAttribute("r",a.radius),b.setAttribute("fill",a.fill),b.setAttribute("stroke",a.stroke),b.setAttribute("class",a.eleClass),b.setPosition=function(a){b.setAttribute("cx",a.x),b.setAttribute("cy",a.y)},b.setStyle=function(a){b.setAttribute("r",a.radius),b.setAttribute("fill",a.fill),b.setAttribute("stroke",a.stroke)},b},createRect:function(a){var b=this.createSvgNode("rect");return b.setAttribute("x",a.x),b.setAttribute("y",a.y),b.setAttribute("width",a.width),b.setAttribute("height",a.height),b.setAttribute("fill",a.fill),b.setPosition=function(a){b.setAttribute("x",a.x),b.setAttribute("y",a.y)},b},createGroup:function(a,b){var c=a||{},d=this.createSvgNode("g");return c.id&&(d.id=c.id),c.eleClass&&d.setAttribute("class",c.eleClass),b&&(this.rootGroup=d),d},applyTransformParams:function(a,b,c){this.rootGroup.setAttribute("transform","scale("+a+") translate("+b+", "+c+")")}}}(window,document);
/*
//@ sourceMappingURL=dist/archerTarget.min.map
*/