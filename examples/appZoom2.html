<!doctype html>
<html>
  <head>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    <title>Complex 1 - Example - jArcherTarget</title>

    <link rel="stylesheet" type="text/css" href="../jarchertarget.css">
    
    <script language="javascript" src="assets/jquery-1.8.1.min.js"></script>
    <script language="javascript" src="../jarchertarget.min.js"></script>
    <script language="javascript" src="../plugins/appZoom2/appZoom2.js"></script>
    <script language="javascript" src="../targets/targets.min.js"></script>

    <style type="text/css">

      html, body {
        margin: 0;
        padding: 0;
      }

      #target {
        width: 400px;
        height: 400px;
      }

    </style>
  </head>
  <body>

    <div style="padding:10px;margin:10px;">
    <div id="target"></div>

    <script language="javascript">

        $(document).ready(function ($) {

            var self = this,
                maxArrowNumber = 6,
                arrowNumber = 0,
                $target = $('#target'),
                touch = true;

            $target.archerTarget({
                target: [
                
                    {
                        name: 'wa_x',
                        center: [25, 27],
                        diameter: 45
                    },
                    {
                        name: 'wa_x',
                        center: [75, 27],
                        diameter: 45
                    },
                    {
                        name: 'wa_x',
                        center: [50, 74],
                        diameter: 45
                    }
                
                ],
                arrows: [     
                    {
                        radius: 8,
                        data: [
                            { x: 50, y: 50 },
                            { x: 50, y: 50 },
                            { x: 50, y: 50 },
                            { x: 50, y: 50 },
                            { x: 50, y: 50 },
                            { x: 50, y: 50 }
                        ],
                        active: false
                    }
                ],
                zoom: 1,
                zoomable: 0,
                draggable: 0,
                plugins: {
                    appZoom2: {
                        scaledZoom: 1.7,
                        tapZoom: 3,
                        width: 100,
                        height: 34,
                        crossWidth: 2,
                        crossColor: '#000'
                    }
                },

                onContainerMousedown: function (e, containerCoordinates, targetCoordinates, event) {

                    if (arrowNumber < maxArrowNumber) {

                        var targetArrows = $target.archerTarget('get', 'arrows'),
                            element = targetArrows[0].data[arrowNumber].element,
                            tempData = [];
                            tempData[arrowNumber] = {
                                x: targetCoordinates.x,
                                y: targetCoordinates.y,
                                target: targetCoordinates.target
                            }

                        $target.archerTarget('set', 'arrowActive', {
                            arrowsetID: 0,
                            arrowID: arrowNumber,
                            active: true
                        });

                        $target.archerTarget('set', 'arrowOptions', {
                            arrowsetID: 0,
                            options: {
                                data: tempData
                            }
                        });

                        element.setAttribute('cx', containerCoordinates.xPx);
                        element.setAttribute('cy', containerCoordinates.yPx);

                        if (!touch) {
                            $(element).trigger('mousedown', []);
                        } else {
                            $(element).trigger('touchstart', [event]);
                        }
                        
                        arrowNumber++;

                        console.log('added arrow: ' + arrowNumber);

                    }
                }
            });
            
        });
    </script>
</div>
  </body>
</html>

